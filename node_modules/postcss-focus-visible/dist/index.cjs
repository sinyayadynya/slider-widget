"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var s=e(require("postcss-selector-parser"));const l=":focus-visible",o=e=>{const o=Object.assign({preserve:!0,replaceWith:".focus-visible",disablePolyfillReadyClass:!1},e),t=s.default().astSync(o.replaceWith);return{postcssPlugin:"postcss-focus-visible",Rule(e,{result:n}){if(!e.selector.toLowerCase().includes(l))return;const r=e.selectors.flatMap((r=>{if(!r.toLowerCase().includes(l))return[r];let a;try{a=s.default().astSync(r)}catch(s){return e.warn(n,`Failed to parse selector : ${r}`),r}if(void 0===a)return[r];let i=!1;if(a.walkPseudos((e=>{e.value.toLowerCase()===l&&(e.nodes&&e.nodes.length||(i=!0,e.replaceWith(t.clone({}))))})),!i)return[r];const u=a.clone();if(!o.disablePolyfillReadyClass){var c,d,f,p,v;if(null!=(c=a.nodes)&&null!=(d=c[0])&&null!=(f=d.nodes)&&f.length)for(let e=0;e<a.nodes[0].nodes.length;e++){const l=a.nodes[0].nodes[e];if("combinator"===l.type||s.default.isPseudoElement(l)){a.nodes[0].insertBefore(l,s.default.className({value:"js-focus-visible"}));break}if(e===a.nodes[0].nodes.length-1){a.nodes[0].append(s.default.className({value:"js-focus-visible"}));break}}null!=(p=a.nodes)&&null!=(v=p[0])&&v.nodes&&(u.nodes[0].prepend(s.default.combinator({value:" "})),u.nodes[0].prepend(s.default.className({value:"js-focus-visible"})))}return[a.toString(),u.toString()]}));r.join(",")!==e.selectors.join(",")&&(e.cloneBefore({selectors:r}),o.preserve||e.remove())}}};o.postcss=!0,module.exports=o;
